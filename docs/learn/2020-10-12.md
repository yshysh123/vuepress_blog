---
title: '2020-10-12'
sidebar: true
categories:
  - learn
date: 2020-10-12
tags:
  - js
---

:::tip
2020-10-12 å­¦ä¹ è®°å½•
:::

<!-- more -->

# JS åŸºç¡€

## æ‰§è¡Œä¸Šä¸‹æ–‡

ç®€è€Œè¨€ä¹‹ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯è¯„ä¼°å’Œæ‰§è¡Œ JavaScript ä»£ç çš„çŽ¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µã€‚æ¯å½“ Javascript ä»£ç åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒéƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œ

JavaScript ä¸­æœ‰ä¸‰ç§æ‰§è¡Œä¸Šä¸‹æ–‡ç±»åž‹

- å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ â€” è¿™æ˜¯é»˜è®¤æˆ–è€…è¯´åŸºç¡€çš„ä¸Šä¸‹æ–‡ï¼Œä»»ä½•ä¸åœ¨å‡½æ•°å†…éƒ¨çš„ä»£ç éƒ½åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ã€‚å®ƒä¼šæ‰§è¡Œä¸¤ä»¶äº‹ï¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„ window å¯¹è±¡ï¼ˆæµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼‰ï¼Œå¹¶ä¸”è®¾ç½® this çš„å€¼ç­‰äºŽè¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚ä¸€ä¸ªç¨‹åºä¸­åªä¼šæœ‰ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡
- å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ â€” æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶, éƒ½ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰å®ƒè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸è¿‡æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶åˆ›å»ºçš„ã€‚å‡½æ•°ä¸Šä¸‹æ–‡å¯ä»¥æœ‰ä»»æ„å¤šä¸ª
- eval å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ â€” æ‰§è¡Œåœ¨ eval å‡½æ•°å†…éƒ¨çš„ä»£ç ä¹Ÿä¼šæœ‰å®ƒå±žäºŽè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ç”±äºŽ JavaScript å¼€å‘è€…å¹¶ä¸ç»å¸¸ä½¿ç”¨ evalï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä¸ä¼šè®¨è®ºå®ƒ

# CSS åŸºç¡€

## flex:1 çš„å«ä¹‰

flex: 1; === flex: 1 1 auto;

- ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤º: flex-grow å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 0ï¼Œå³å¦‚æžœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§
- ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤º: flex-shrink å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 1ï¼Œå³å¦‚æžœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°
- ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤º: flex-basis ç»™ä¸Šé¢ä¸¤ä¸ªå±žæ€§åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰, è®¡ç®—é¡¹ç›®æ˜¯å¦æœ‰å¤šä½™ç©ºé—´, é»˜è®¤å€¼ä¸º auto, å³é¡¹ç›®æœ¬èº«çš„å¤§å°

# æ‰‹å†™ JS

## æ•°ç»„æ‰å¹³åŒ–

æ•°ç»„æ‰å¹³åŒ–æ˜¯æŒ‡å°†ä¸€ä¸ªå¤šç»´æ•°ç»„å˜ä¸ºä¸€ä¸ªä¸€ç»´æ•°ç»„

```javascript
const arr = [1, [2, [3, [4, 5]]], 6];
// => [1, 2, 3, 4, 5, 6]
```

1. æ–¹æ³•ä¸€ï¼šä½¿ç”¨ flat()

```js
const res1 = arr.flat(Infinity);
```

2. æ–¹æ³•äºŒï¼šåˆ©ç”¨æ­£åˆ™

```js
const res2 = JSON.stringify(arr)
  .replace(/\[|\]/g, '')
  .split(',');
```

ä½†æ•°æ®ç±»åž‹éƒ½ä¼šå˜ä¸ºå­—ç¬¦ä¸²

3. æ–¹æ³•ä¸‰ï¼šæ­£åˆ™æ”¹è‰¯ç‰ˆæœ¬

```js
const res3 = JSON.parse('[' + JSON.stringify(arr).replace(/\[|\]/g, '') + ']');
```

4. æ–¹æ³•å››ï¼šä½¿ç”¨ reduce

```js
const flatten = (arr) => {
  return arr.reduce((pre, cur) => {
    return pre.concat(Array.isArray(cur) ? flatten(cur) : cur);
  }, []);
};
const res4 = flatten(arr);
```

5. æ–¹æ³•äº”ï¼šå‡½æ•°é€’å½’

```js
const res5 = [];
const fn = (arr) => {
  for (let i = 0; i < arr.length; i++) {
    if (Array.isArray(arr[i])) {
      fn(arr[i]);
    } else {
      res5.push(arr[i]);
    }
  }
};
fn(arr);
```

# æµè§ˆå™¨çŸ¥è¯†

## XSS æ”»å‡»

### ã€ŒXSS è·¨ç«™è¯·æ±‚æ”»å‡»ã€

ä»¥ä¸‹éƒ½æ˜¯å¯èƒ½å‘ç”Ÿçš„ XSS æ³¨å…¥æ”»å‡»

- åœ¨ HTML ä¸­å†…åµŒçš„æ–‡æœ¬ä¸­ï¼Œæ¶æ„å†…å®¹ä»¥ script æ ‡ç­¾å½¢æˆæ³¨å…¥
- åœ¨å†…è”çš„ JavaScript ä¸­ï¼Œæ‹¼æŽ¥çš„æ•°æ®çªç ´äº†åŽŸæœ¬çš„é™åˆ¶ï¼ˆå­—ç¬¦ä¸²ï¼Œå˜é‡ï¼Œæ–¹æ³•åç­‰ï¼‰
- åœ¨æ ‡ç­¾å±žæ€§ä¸­ï¼Œæ¶æ„å†…å®¹åŒ…å«å¼•å·ï¼Œä»Žè€Œçªç ´å±žæ€§å€¼çš„é™åˆ¶ï¼Œæ³¨å…¥å…¶ä»–å±žæ€§æˆ–è€…æ ‡ç­¾
- åœ¨æ ‡ç­¾çš„ hrefã€src ç­‰å±žæ€§ä¸­ï¼ŒåŒ…å« javascript: ç­‰å¯æ‰§è¡Œä»£ç 
- åœ¨ onloadã€onerrorã€onclick ç­‰äº‹ä»¶ä¸­ï¼Œæ³¨å…¥ä¸å—æŽ§åˆ¶ä»£ç 
- åœ¨ style å±žæ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ background-image:url("javascript:..."); çš„ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰
- åœ¨ style å±žæ€§å’Œæ ‡ç­¾ä¸­ï¼ŒåŒ…å«ç±»ä¼¼ expression(...) çš„ CSS è¡¨è¾¾å¼ä»£ç ï¼ˆæ–°ç‰ˆæœ¬æµè§ˆå™¨å·²ç»å¯ä»¥é˜²èŒƒï¼‰
- ã€ŒXSS æ”»å‡»åœºæ™¯ã€ä¸€ä¸ªåšå®¢ç½‘ç«™ï¼Œæˆ‘å‘è¡¨ä¸€ç¯‡åšå®¢ï¼Œå…¶ä¸­åµŒå…¥ script è„šæœ¬ï¼Œè„šæœ¬å†…å®¹ï¼šèŽ·å– cookieï¼Œå‘é€åˆ°æˆ‘çš„æœåŠ¡å™¨ï¼ˆæœåŠ¡å™¨é…åˆè·¨åŸŸï¼‰é˜…è¯»äº†çš„äººçš„ cookie å°±ä¼šè¢«ç›—å–

### ã€ŒXSS é¢„é˜²ã€

- â‘  æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚<å˜ä¸º&lt;ï¼Œ>å˜ä¸º&gt;
- â‘¡ é‚£ä¹ˆ script å°±ä¼šå˜ä¸º&lt;script&gt;ï¼Œç›´æŽ¥æ˜¾ç¤ºï¼Œè€Œä¸ä¼šä½œä¸ºè„šæœ¬æ‰§è¡Œ
- â‘¢ å‰ç«¯è¦æ›¿æ¢ï¼ŒåŽç«¯ä¹Ÿè¦åšæ›¿æ¢ï¼ŒåŒä¿é™©
- â‘£ ä¸»æµçš„å‰ç«¯æ¡†æž¶å·²åšå¥½é¢„é˜²
- â‘¤ åˆ©ç”¨ç¬¬ä¸‰æ–¹æ¡†æž¶ xss è¿›è¡Œè½¬ä¹‰ï¼ŒåŽŸç†ä¹Ÿç±»ä¼¼äºŽ 1ã€2 æ¡
- â‘¥ åˆ©ç”¨ CSP
- â‘¦ cookie httpOnly

# ç®—æ³•

## å­—æ¯å¤§å°å†™å…¨æŽ’åˆ—

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œé€šè¿‡å°†å­—ç¬¦ä¸² S ä¸­çš„æ¯ä¸ªå­—æ¯è½¬å˜å¤§å°å†™ï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å¾—ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚è¿”å›žæ‰€æœ‰å¯èƒ½å¾—åˆ°çš„å­—ç¬¦ä¸²é›†åˆã€‚

è¾“å…¥ï¼šS = "a1b2" è¾“å‡ºï¼š["a1b2", "a1B2", "A1b2", "A1B2"]

è¾“å…¥ï¼šS = "3z4" è¾“å‡ºï¼š["3z4", "3Z4"]

è¾“å…¥ï¼šS = "12345" è¾“å‡ºï¼š["12345"]

æç¤ºï¼šS çš„é•¿åº¦ä¸è¶…è¿‡ 12ã€‚ S ä»…ç”±æ•°å­—å’Œå­—æ¯ç»„æˆã€‚

```js
// æ€è·¯ï¼š
// å¯¹äºŽæ•°å­—è€Œè¨€çš„è¯ï¼Œæˆ‘ä»¬ç›´æŽ¥è·³è¿‡ï¼Œå­—æ¯çš„è¯ï¼Œæ— éžå°±æ˜¯ä¸¤ç§çŠ¶æ€ï¼Œå¤§å°å†™å­—æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰æŽ¥ä¸‹æ¥çš„æ€è·¯ðŸ‘‡

// - é‡åˆ°æ•°å­—çš„è¯ï¼Œä¸ä¼šæ¶‰åŠæ–°çš„åˆ†æ”¯ï¼Œæˆ‘ä»¬å°±ç›´æŽ¥å¾€åŽæœï¼Œè¿™æ ·å­çš„è¯ï¼Œå¯¹äºŽæ•°å­—å°±åªéœ€è¦æœç´¢ä¸€æ¬¡ã€‚
// - å¯¹äºŽå•ä¸ªå­—æ¯è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦**æœç´¢2æ¬¡**ï¼Œå°å†™å­—æ¯æœç´¢ä¸€æ¬¡ï¼Œå¤§å†™å­—æ¯æœç´¢ä¸€æ¬¡ã€‚
// - æˆ‘ä»¬å¯ä»¥åŽ»ç»´æŠ¤ä¸€ä¸ªindexï¼Œé‡åˆ°æ•°å­—çš„è¯ï¼Œindex+1ï¼Œç»§ç»­é€’å½’ï¼Œé‡åˆ°å­—æ¯çš„è¯ï¼Œéœ€è¦é€’å½’ä¸¤æ¬¡ï¼Œå‡è®¾å½“å­—æ¯æ˜¯å°å†™æ—¶ï¼Œæˆ‘ä»¬é€’å½’ä¸€æ¬¡(index+1),ç„¶åŽå›žæº¯æ—¶å°†å­—æ¯è½¬ä¸ºå¤§å†™ï¼ŒåˆåŽ»é€’å½’ä¸€æ¬¡ã€‚
// - é€’å½’å°½å¤´ï¼šå³æœç´¢å®Œæ•´ä¸ªå­—ç¬¦ä¸²ä¸ºæ­¢ï¼Œæˆ‘ä»¬å‰é¢ç»´æŠ¤çš„indexï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½œä¸ºæ¡ä»¶åˆ¤æ–­ã€‚
const letterCasePermutation = (S) => {
  const ans = [];
  const backtrack = (str, i) => {
    if (i === S.length) {
      return ans.push(str);
    }
    const curr = S[i];
    if ((curr >= 'A' && curr <= 'Z') || (curr >= 'a' && curr <= 'z')) {
      // å¤§å°å†™å­—æ¯æœç´¢ä¸¤æ¬¡
      const low = str + curr.toLowerCase(),
        high = str + curr.toUpperCase();
      backtrack(low, i + 1);
      backtrack(high, i + 1);
    } else {
      // æ•°å­—çš„è¯,ç›´æŽ¥ç»§ç»­é€’å½’
      backtrack(str + curr, i + 1);
    }
  };
  backtrack('', 0);
  return ans;
};
```

# Vue çŸ¥è¯†

Vue2.0 çš„ç”Ÿå‘½å‘¨æœŸ

- beforeCreate æ˜¯ new Vue()ä¹‹åŽè§¦å‘çš„ç¬¬ä¸€ä¸ªé’©å­ï¼Œåœ¨å½“å‰é˜¶æ®µ dataã€methodsã€computed ä»¥åŠ watch ä¸Šçš„æ•°æ®å’Œæ–¹æ³•éƒ½ä¸èƒ½è¢«è®¿é—®ã€‚
- created åœ¨å®žä¾‹åˆ›å»ºå®ŒæˆåŽå‘ç”Ÿï¼Œå½“å‰é˜¶æ®µå·²ç»å®Œæˆäº†æ•°æ®è§‚æµ‹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨æ•°æ®ï¼Œæ›´æ”¹æ•°æ®ï¼Œåœ¨è¿™é‡Œæ›´æ”¹æ•°æ®ä¸ä¼šè§¦å‘ updated å‡½æ•°ã€‚å¯ä»¥åšä¸€äº›åˆå§‹æ•°æ®çš„èŽ·å–ï¼Œåœ¨å½“å‰é˜¶æ®µæ— æ³•ä¸Ž Dom è¿›è¡Œäº¤äº’ï¼Œå¦‚æžœéžè¦æƒ³ï¼Œå¯ä»¥é€šè¿‡ vm.\$nextTick æ¥è®¿é—® Domã€‚
- beforeMount å‘ç”Ÿåœ¨æŒ‚è½½ä¹‹å‰ï¼Œåœ¨è¿™ä¹‹å‰ template æ¨¡æ¿å·²å¯¼å…¥æ¸²æŸ“å‡½æ•°ç¼–è¯‘ã€‚è€Œå½“å‰é˜¶æ®µè™šæ‹Ÿ Dom å·²ç»åˆ›å»ºå®Œæˆï¼Œå³å°†å¼€å§‹æ¸²æŸ“ã€‚åœ¨æ­¤æ—¶ä¹Ÿå¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ›´æ”¹ï¼Œä¸ä¼šè§¦å‘ updatedã€‚
- mounted åœ¨æŒ‚è½½å®ŒæˆåŽå‘ç”Ÿï¼Œåœ¨å½“å‰é˜¶æ®µï¼ŒçœŸå®žçš„ Dom æŒ‚è½½å®Œæ¯•ï¼Œæ•°æ®å®ŒæˆåŒå‘ç»‘å®šï¼Œå¯ä»¥è®¿é—®åˆ° Dom èŠ‚ç‚¹ï¼Œä½¿ç”¨\$refs å±žæ€§å¯¹ Dom è¿›è¡Œæ“ä½œã€‚
- beforeUpdate å‘ç”Ÿåœ¨æ›´æ–°ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯å“åº”å¼æ•°æ®å‘ç”Ÿæ›´æ–°ï¼Œè™šæ‹Ÿ dom é‡æ–°æ¸²æŸ“ä¹‹å‰è¢«è§¦å‘ï¼Œä½ å¯ä»¥åœ¨å½“å‰é˜¶æ®µè¿›è¡Œæ›´æ”¹æ•°æ®ï¼Œä¸ä¼šé€ æˆé‡æ¸²æŸ“ã€‚
- updated å‘ç”Ÿåœ¨æ›´æ–°å®Œæˆä¹‹åŽï¼Œå½“å‰é˜¶æ®µç»„ä»¶ Dom å·²å®Œæˆæ›´æ–°ã€‚è¦æ³¨æ„çš„æ˜¯é¿å…åœ¨æ­¤æœŸé—´æ›´æ”¹æ•°æ®ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´æ— é™å¾ªçŽ¯çš„æ›´æ–°ã€‚
- beforeDestroy å‘ç”Ÿåœ¨å®žä¾‹é”€æ¯ä¹‹å‰ï¼Œåœ¨å½“å‰é˜¶æ®µå®žä¾‹å®Œå…¨å¯ä»¥è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™æ—¶è¿›è¡Œå–„åŽæ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚æ¸…é™¤è®¡æ—¶å™¨ã€‚
- destroyed å‘ç”Ÿåœ¨å®žä¾‹é”€æ¯ä¹‹åŽï¼Œè¿™ä¸ªæ—¶å€™åªå‰©ä¸‹äº† dom ç©ºå£³ã€‚ç»„ä»¶å·²è¢«æ‹†è§£ï¼Œæ•°æ®ç»‘å®šè¢«å¸é™¤ï¼Œç›‘å¬è¢«ç§»å‡ºï¼Œå­å®žä¾‹ä¹Ÿç»Ÿç»Ÿè¢«é”€æ¯ã€‚

# React çŸ¥è¯†

setState åˆ°åº•æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥?

1. setState åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŽŸç”Ÿäº‹ä»¶å’Œ setTimeoutÂ  ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚
2. setStateÂ  çš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®žçŽ°ï¼Œå…¶å®žæœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åŽçš„å€¼ï¼Œå½¢æˆäº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° Â setState(partialState, callback)Â  ä¸­çš„ callback æ‹¿åˆ°æ›´æ–°åŽçš„ç»“æžœã€‚
3. setStateÂ  çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŽŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æžœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ setStateï¼ŒsetState çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åŽä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æžœæ˜¯åŒæ—¶ setState å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚
